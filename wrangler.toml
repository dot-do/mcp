# MCP Server - Cloudflare Worker Configuration
# https://developers.cloudflare.com/workers/wrangler/configuration/

name = "mcp"
main = "src/worker/index.ts"
compatibility_date = "2024-01-01"

# Enable Node.js compatibility for packages that need it
compatibility_flags = ["nodejs_compat"]

# Environment variables (non-sensitive)
[vars]
AUTH_MODE = "anon+auth"

# Development settings
[dev]
port = 8787
local_protocol = "http"
ip = "0.0.0.0"

# Production environment
[env.production]
name = "mcp-production"
vars = { AUTH_MODE = "auth-required" }

# Staging environment
[env.staging]
name = "mcp-staging"
vars = { AUTH_MODE = "anon+auth" }

# Rate limiting Durable Object (optional)
# Uncomment when implementing rate limiting
# [[durable_objects.bindings]]
# name = "RATE_LIMITER"
# class_name = "RateLimiter"

# [[migrations]]
# tag = "v1"
# new_classes = ["RateLimiter"]

# Observability settings
[observability]
enabled = true
head_sampling_rate = 1

# Build settings
[build]
command = "npm run build"

# Minification settings
[build.upload]
format = "modules"
main = "./dist/worker/index.js"
